<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dirigo Sea Farm Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .slider-container { background: #f3f4f6; border: 1px solid #e5e7eb; }
    .output-container { background: #fef3c7; border: 1px solid #fde68a; }
    .config-container { background: #dbeafe; border: 1px solid #bfdbfe; }
    .tab-button { cursor: pointer; }
    .tab-button.active { background: #2563eb !important; color: white !important; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .help-text { font-size: 0.75rem; color: #6b7280; font-style: italic; }
  </style>
</head>
<body class="bg-gray-50 p-4">
  <div class="max-w-7xl mx-auto">
    
    <!-- Header -->
    <div class="bg-white rounded-lg shadow p-6 mb-6">
      <h1 class="text-3xl font-bold text-center">Dirigo Sea Farm Dashboard</h1>
      <p class="text-gray-600 text-center mt-2">Integrated Cost Modeling & Business Metrics</p>
    </div>

    <!-- Tabs -->
    <div class="bg-white rounded-lg shadow p-4 mb-6">
      <div class="flex gap-2">
        <button class="tab-button active px-4 py-2 rounded bg-gray-100" data-tab="cogs">COGs Analysis</button>
        <button class="tab-button px-4 py-2 rounded bg-gray-100" data-tab="sales">Sales & Revenue</button>
        <button class="tab-button px-4 py-2 rounded bg-gray-100" data-tab="overview">Business Overview</button>
        <button class="tab-button px-4 py-2 rounded bg-gray-100" data-tab="config">Configuration</button>
      </div>
    </div>

    <!-- Tab: COGs -->
    <div id="cogs" class="tab-content active">
      
      <!-- Production Inputs -->
      <div class="bg-white rounded-lg shadow p-6 mb-6">
        <h2 class="text-xl font-bold mb-4">Production Inputs</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          
          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">Seaweed Price ($/lb)</label>
            <div class="flex justify-between text-sm mt-1">
              <span>$4</span>
              <span class="font-bold">$<span id="seaweedPriceVal">8.00</span></span>
              <span>$15</span>
            </div>
            <input type="range" id="seaweedPrice" min="4" max="15" step="0.25" value="8" class="w-full mt-2">
          </div>

          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">Alginate Yield (%)</label>
            <div class="flex justify-between text-sm mt-1">
              <span>8%</span>
              <span class="font-bold"><span id="yieldVal">12</span>%</span>
              <span>20%</span>
            </div>
            <input type="range" id="alginateYield" min="8" max="20" step="0.5" value="12" class="w-full mt-2">
          </div>

          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">Ethanol Recovery (%)</label>
            <div class="flex justify-between text-sm mt-1">
              <span>0%</span>
              <span class="font-bold"><span id="ethanolVal">0</span>%</span>
              <span>95%</span>
            </div>
            <input type="range" id="ethanolRecovery" min="0" max="95" step="5" value="0" class="w-full mt-2">
          </div>

          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">Microalgae Cost ($/lb)</label>
            <div class="flex justify-between text-sm mt-1">
              <span>$0.50</span>
              <span class="font-bold">$<span id="microVal">1.00</span></span>
              <span>$5</span>
            </div>
            <input type="range" id="microalgaeCost" min="0.5" max="5" step="0.1" value="1" class="w-full mt-2">
          </div>

          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">% Macro in Resin Blend</label>
            <div class="flex justify-between text-sm mt-1">
              <span>0%</span>
              <span class="font-bold"><span id="macroVal">20</span>%</span>
              <span>100%</span>
            </div>
            <input type="range" id="macroBlend" min="0" max="100" step="5" value="20" class="w-full mt-2">
            <p class="text-xs text-gray-600 mt-1">Micro: <span id="microBlendVal">80</span>%</p>
          </div>

        </div>
      </div>

      <!-- COGs Outputs -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        
        <div class="output-container rounded-lg p-6">
          <h3 class="text-lg font-semibold mb-2">Sodium Alginate COG</h3>
          <p class="text-xs text-gray-600">Target: $20/lb</p>
          <p class="text-3xl font-bold text-blue-600 mt-2">$<span id="alginateCOG">0.00</span>/lb</p>
          <p class="help-text mt-3">Base extracted alginate cost</p>
        </div>

        <div class="output-container rounded-lg p-6">
          <h3 class="text-lg font-semibold mb-2">DirigoDrip Film COG</h3>
          <p class="text-xs text-gray-600">Target: $8/lb</p>
          <p class="text-3xl font-bold text-green-600 mt-2">$<span id="filmCOG">0.00</span>/lb</p>
          <p class="help-text mt-3">40% Alginate (95% 3rd party @ $22/lb, 5% Dirigo) + 60% Glycerol</p>
        </div>

        <div class="output-container rounded-lg p-6">
          <h3 class="text-lg font-semibold mb-2">HoldFast Resin COG</h3>
          <p class="text-xs text-gray-600">Target: $2.75/lb</p>
          <p class="text-3xl font-bold text-purple-600 mt-2">$<span id="resinCOG">0.00</span>/lb</p>
          <p class="help-text mt-3">60% Glycerin + 40% Blended Input</p>
        </div>

      </div>
    </div>

    <!-- Tab: Sales -->
    <div id="sales" class="tab-content">
      <div class="bg-white rounded-lg shadow p-6 mb-6">
        <h2 class="text-xl font-bold mb-4">Sales Inputs</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          
          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">Film Sales Volume (lbs)</label>
            <div class="flex justify-between text-sm mt-1">
              <span>0</span>
              <span class="font-bold"><span id="filmVolVal">36,000</span></span>
              <span>100k</span>
            </div>
            <input type="range" id="filmVolume" min="0" max="100000" step="1000" value="36000" class="w-full mt-2">
          </div>

          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">Film Price ($/lb)</label>
            <div class="flex justify-between text-sm mt-1">
              <span>$5</span>
              <span class="font-bold">$<span id="filmPriceVal">10.00</span></span>
              <span>$20</span>
            </div>
            <input type="range" id="filmPrice" min="5" max="20" step="0.5" value="10" class="w-full mt-2">
          </div>

          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">Resin Sales Volume (lbs)</label>
            <div class="flex justify-between text-sm mt-1">
              <span>0</span>
              <span class="font-bold"><span id="resinVolVal">900,000</span></span>
              <span>2M</span>
            </div>
            <input type="range" id="resinVolume" min="0" max="2000000" step="10000" value="900000" class="w-full mt-2">
          </div>

          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">Resin Price ($/lb)</label>
            <div class="flex justify-between text-sm mt-1">
              <span>$2</span>
              <span class="font-bold">$<span id="resinPriceVal">2.75</span></span>
              <span>$5</span>
            </div>
            <input type="range" id="resinPrice" min="2" max="5" step="0.05" value="2.75" class="w-full mt-2">
          </div>

          <div class="slider-container p-4 rounded">
            <label class="font-semibold text-sm">Waste Price ($/lb)</label>
            <div class="flex justify-between text-sm mt-1">
              <span>$0</span>
              <span class="font-bold">$<span id="wastePriceVal">7.50</span></span>
              <span>$15</span>
            </div>
            <input type="range" id="wastePrice" min="0" max="15" step="0.5" value="7.5" class="w-full mt-2">
          </div>

        </div>
      </div>

      <!-- Revenue Outputs -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="output-container rounded p-4">
          <h4 class="text-sm font-semibold">Film Revenue</h4>
          <p class="text-xl font-bold text-green-600">$<span id="filmRev">0</span></p>
        </div>
        <div class="output-container rounded p-4">
          <h4 class="text-sm font-semibold">Resin Revenue</h4>
          <p class="text-xl font-bold text-purple-600">$<span id="resinRev">0</span></p>
        </div>
        <div class="output-container rounded p-4">
          <h4 class="text-sm font-semibold">Waste Revenue</h4>
          <p class="text-xl font-bold text-amber-600">$<span id="wasteRev">0</span></p>
        </div>
        <div class="output-container rounded p-4">
          <h4 class="text-sm font-semibold">Total Revenue</h4>
          <p class="text-xl font-bold text-blue-700">$<span id="totalRev">0</span></p>
        </div>
      </div>
    </div>

    <!-- Tab: Overview -->
    <div id="overview" class="tab-content">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        
        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="text-lg font-semibold mb-4">Annual Metrics</h3>
          <div class="space-y-2">
            <div class="flex justify-between">
              <span class="text-sm text-gray-600">Revenue</span>
              <span class="font-bold">$<span id="annualRev">0</span></span>
            </div>
            <div class="flex justify-between">
              <span class="text-sm text-gray-600">COGS</span>
              <span class="font-bold text-red-600">$<span id="annualCOGS">0</span></span>
            </div>
            <div class="flex justify-between">
              <span class="text-sm text-gray-600">Gross Profit</span>
              <span class="font-bold text-green-600">$<span id="grossProfit">0</span></span>
            </div>
            <div class="flex justify-between">
              <span class="text-sm text-gray-600">OpEx</span>
              <span class="font-bold text-amber-600">$<span id="opEx">438,000</span></span>
            </div>
            <div class="flex justify-between">
              <span class="text-sm text-gray-600">Net Income</span>
              <span class="font-bold">$<span id="netIncome">0</span></span>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="text-lg font-semibold mb-4">Margins</h3>
          <div class="space-y-3">
            <div>
              <p class="text-sm text-gray-600">Gross Margin</p>
              <p class="text-2xl font-bold"><span id="grossMargin">0</span>%</p>
            </div>
            <div>
              <p class="text-sm text-gray-600">Film Margin</p>
              <p class="text-xl font-semibold text-green-600"><span id="filmMargin">0</span>%</p>
            </div>
            <div>
              <p class="text-sm text-gray-600">Resin Margin</p>
              <p class="text-xl font-semibold text-purple-600"><span id="resinMargin">0</span>%</p>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="text-lg font-semibold mb-4">Cash Position</h3>
          <div class="space-y-3">
            <div>
              <p class="text-sm text-gray-600">Monthly Burn</p>
              <p class="text-2xl font-bold text-red-600">$<span id="monthlyBurn">0</span></p>
            </div>
            <div>
              <p class="text-sm text-gray-600">Current Cash</p>
              <p class="text-xl font-semibold">$3,787,448</p>
            </div>
            <div>
              <p class="text-sm text-gray-600">Runway</p>
              <p class="text-xl font-semibold text-blue-600"><span id="runway">0</span> months</p>
            </div>
          </div>
        </div>

      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="text-lg font-semibold mb-4">Revenue Breakdown</h3>
          <canvas id="revenueChart" height="200"></canvas>
        </div>
        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="text-lg font-semibold mb-4">Cost Structure</h3>
          <canvas id="costChart" height="200"></canvas>
        </div>
      </div>
    </div>

    <!-- Tab: Config -->
    <div id="config" class="tab-content">
      <div class="config-container rounded-lg p-6">
        <h2 class="text-xl font-bold mb-4">Configuration</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <h3 class="font-semibold mb-3">OpEx Settings</h3>
            <div class="space-y-2">
              <div class="flex items-center gap-2">
                <label class="text-sm w-20">R&D:</label>
                <input type="number" id="rndExp" value="150000" class="px-2 py-1 border rounded">
              </div>
              <div class="flex items-center gap-2">
                <label class="text-sm w-20">SG&A:</label>
                <input type="number" id="sgaExp" value="200000" class="px-2 py-1 border rounded">
              </div>
              <div class="flex items-center gap-2">
                <label class="text-sm w-20">Other:</label>
                <input type="number" id="otherExp" value="88000" class="px-2 py-1 border rounded">
              </div>
            </div>
          </div>
        </div>
        <!-- Global Slider Range Controls -->
<div class="mt-6">
  <h3 class="font-semibold mb-3">Global slider range</h3>

  <div class="flex items-center gap-3 mb-2">
    <label class="text-sm w-40">Min scale factor</label>
    <input type="number" id="minScale" value="1" step="0.1" class="px-2 py-1 border rounded">
  </div>

  <div class="flex items-center gap-3 mb-2">
    <label class="text-sm w-40">Max scale factor</label>
    <input type="number" id="maxScale" value="1" step="0.1" class="px-2 py-1 border rounded">
  </div>

  <button id="applySliderRanges" class="bg-blue-600 text-white px-4 py-2 rounded">
    Apply slider ranges
  </button>

  <p class="help-text mt-2">Example: Min 0.5 and Max 0.8 will shrink all sliders to 50%–80% of the original range.</p>
</div>
        <button id="applyConfig" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded">Apply Config</button>
      </div>
    </div>

  </div>

  <script>
    // Constants
    const ETHANOL_BASE = 71.98;
    const ETHANOL_USE = 0.462;
    const SODIUM_BICARB = 1.00;
    const SODIUM_USE = 1.98;
    const GLYCEROL = 1.03;
    const GLYCEROL_KG = 0.6;
    const ALGINATE_KG = 0.4;
    const THIRD_PARTY_ALGINATE = 22;
    const DIRIGO_ALGINATE_SHARE = 0.05;
    const KG_LB = 2.20462;
    
    let revenueChart = null;
    let costChart = null;
    let opEx = 438000;

    // Tab switching
    document.querySelectorAll('.tab-button').forEach(function(btn) {
      btn.addEventListener('click', function() {
        const tabName = this.getAttribute('data-tab');
        
        // Update buttons
        document.querySelectorAll('.tab-button').forEach(function(b) {
          b.classList.remove('active');
        });
        this.classList.add('active');
        
        // Update content
        document.querySelectorAll('.tab-content').forEach(function(content) {
          content.classList.remove('active');
        });
        document.getElementById(tabName).classList.add('active');
        
        // Update charts if overview
        if (tabName === 'overview') {
          setTimeout(updateCharts, 100);
        }
      });
    });

    // Calculate function
    function calculate() {
      // Get values
      const seaweedPrice = parseFloat(document.getElementById('seaweedPrice').value);
      const alginateYield = parseFloat(document.getElementById('alginateYield').value) / 100;
      const ethanolRecovery = parseFloat(document.getElementById('ethanolRecovery').value) / 100;
      const microCost = parseFloat(document.getElementById('microalgaeCost').value);
      const macroBlend = parseFloat(document.getElementById('macroBlend').value) / 100;
      
      const filmVol = parseFloat(document.getElementById('filmVolume').value);
      const filmPr = parseFloat(document.getElementById('filmPrice').value);
      const resinVol = parseFloat(document.getElementById('resinVolume').value);
      const resinPr = parseFloat(document.getElementById('resinPrice').value);
      const wastePr = parseFloat(document.getElementById('wastePrice').value);

      // Update displays
      document.getElementById('seaweedPriceVal').textContent = seaweedPrice.toFixed(2);
      document.getElementById('yieldVal').textContent = (alginateYield * 100).toFixed(1);
      document.getElementById('ethanolVal').textContent = (ethanolRecovery * 100);
      document.getElementById('microVal').textContent = microCost.toFixed(2);
      document.getElementById('macroVal').textContent = (macroBlend * 100);
      document.getElementById('microBlendVal').textContent = ((1-macroBlend) * 100);
      document.getElementById('filmVolVal').textContent = filmVol.toLocaleString();
      document.getElementById('filmPriceVal').textContent = filmPr.toFixed(2);
      document.getElementById('resinVolVal').textContent = resinVol.toLocaleString();
      document.getElementById('resinPriceVal').textContent = resinPr.toFixed(2);
      document.getElementById('wastePriceVal').textContent = wastePr.toFixed(2);

      // Calculate COGs
      const seaweedCost = seaweedPrice * 6;
      const ethanolCost = ETHANOL_BASE * ETHANOL_USE * (1 - ethanolRecovery);
      const sodiumCost = SODIUM_BICARB * SODIUM_USE;
      const totalCost = seaweedCost + ethanolCost + sodiumCost;
      const alginateLbs = 6 * alginateYield;
      const alginateCOG = totalCost / Math.max(alginateLbs, 0.01);
      
      const blendedAlginateCOG = (DIRIGO_ALGINATE_SHARE * alginateCOG) +
        ((1 - DIRIGO_ALGINATE_SHARE) * THIRD_PARTY_ALGINATE);
      const algKg = blendedAlginateCOG * KG_LB;
      const filmMat = (GLYCEROL * GLYCEROL_KG) + (algKg * ALGINATE_KG);
      const filmCOG = filmMat / KG_LB;
      
      const blendedInput = (macroBlend * alginateCOG) + ((1-macroBlend) * microCost);
      const glycerinPerLb = GLYCEROL / KG_LB;
      const resinCOG = (0.6 * glycerinPerLb) + (0.4 * blendedInput);
      
      // Calculate waste
      const algForResin = resinVol * macroBlend * 0.4;
      const seaweedForResin = algForResin / Math.max(alginateYield, 0.01);
      const algForFilm = filmVol * ALGINATE_KG / KG_LB;
      const seaweedForFilm = algForFilm / Math.max(alginateYield, 0.01);
      const totalWaste = (seaweedForResin + seaweedForFilm) * (1 - alginateYield);
      
      // Calculate revenues
      const filmRev = filmVol * filmPr;
      const resinRev = resinVol * resinPr;
      const wasteRev = totalWaste * wastePr;
      const totalRev = filmRev + resinRev + wasteRev;
      
      // Calculate COGS and profit
      const filmCOGS = filmVol * filmCOG;
      const resinCOGS = resinVol * resinCOG;
      const totalCOGS = filmCOGS + resinCOGS;
      const gross = totalRev - totalCOGS;
      const net = gross - opEx;
      
      // Calculate margins
      const grossMargin = totalRev > 0 ? (gross / totalRev * 100) : 0;
      const filmMargin = filmPr > 0 ? ((filmPr - filmCOG) / filmPr * 100) : 0;
      const resinMargin = resinPr > 0 ? ((resinPr - resinCOG) / resinPr * 100) : 0;
      
      // Calculate burn
      const burn = net < 0 ? Math.abs(net / 12) : 0;
      const runway = burn > 0 ? (3787448 / burn) : 999;

      // Update all displays
      document.getElementById('alginateCOG').textContent = alginateCOG.toFixed(2);
      document.getElementById('filmCOG').textContent = filmCOG.toFixed(2);
      document.getElementById('resinCOG').textContent = resinCOG.toFixed(2);
      
      document.getElementById('filmRev').textContent = Math.round(filmRev).toLocaleString();
      document.getElementById('resinRev').textContent = Math.round(resinRev).toLocaleString();
      document.getElementById('wasteRev').textContent = Math.round(wasteRev).toLocaleString();
      document.getElementById('totalRev').textContent = Math.round(totalRev).toLocaleString();
      
      document.getElementById('annualRev').textContent = Math.round(totalRev).toLocaleString();
      document.getElementById('annualCOGS').textContent = Math.round(totalCOGS).toLocaleString();
      document.getElementById('grossProfit').textContent = Math.round(gross).toLocaleString();
      document.getElementById('netIncome').textContent = Math.round(net).toLocaleString();
      document.getElementById('grossMargin').textContent = grossMargin.toFixed(1);
      document.getElementById('filmMargin').textContent = filmMargin.toFixed(1);
      document.getElementById('resinMargin').textContent = resinMargin.toFixed(1);
      document.getElementById('monthlyBurn').textContent = Math.round(burn).toLocaleString();
      document.getElementById('runway').textContent = runway > 999 ? '∞' : runway.toFixed(1);
    }

    // Update charts
    function updateCharts() {
      const ctx1 = document.getElementById('revenueChart');
      const ctx2 = document.getElementById('costChart');
      
      if (ctx1) {
        if (revenueChart) revenueChart.destroy();
        revenueChart = new Chart(ctx1, {
          type: 'pie',
          data: {
            labels: ['Film', 'Resin', 'Waste'],
            datasets: [{
              data: [
                parseFloat(document.getElementById('filmVolume').value) * parseFloat(document.getElementById('filmPrice').value),
                parseFloat(document.getElementById('resinVolume').value) * parseFloat(document.getElementById('resinPrice').value),
                parseFloat(document.getElementById('wasteRev').textContent.replace(/,/g, ''))
              ],
              backgroundColor: ['#10b981', '#8b5cf6', '#f59e0b']
            }]
          }
        });
      }
      
      if (ctx2) {
        if (costChart) costChart.destroy();
        costChart = new Chart(ctx2, {
          type: 'bar',
          data: {
            labels: ['Film COGS', 'Resin COGS', 'OpEx'],
            datasets: [{
              data: [
                parseFloat(document.getElementById('filmVolume').value) * parseFloat(document.getElementById('filmCOG').textContent),
                parseFloat(document.getElementById('resinVolume').value) * parseFloat(document.getElementById('resinCOG').textContent),
                opEx
              ],
              backgroundColor: ['#10b981', '#8b5cf6', '#ef4444']
            }]
          }
        });
      }
    }
// Global slider range logic
const defaultBounds = {
  seaweedPrice:   { min: 4, max: 15, unit: '$' },
  alginateYield:  { min: 8, max: 20, unit: '%' },
  ethanolRecovery:{ min: 0, max: 95, unit: '%' },
  microalgaeCost: { min: 0.5, max: 5, unit: '$' },
  macroBlend:     { min: 0, max: 100, unit: '%' },
  filmVolume:     { min: 0, max: 100000, unit: '' },
  filmPrice:      { min: 5, max: 20, unit: '$' },
  resinVolume:    { min: 0, max: 2000000, unit: '' },
  resinPrice:     { min: 2, max: 5, unit: '$' },
  wastePrice:     { min: 0, max: 15, unit: '$' }
};

function applySliderBoundsFromScales() {
  const minScale = parseFloat(document.getElementById('minScale').value) || 1;
  const maxScale = parseFloat(document.getElementById('maxScale').value) || 1;

  Object.entries(defaultBounds).forEach(([id, b]) => {
    const el = document.getElementById(id);
    if (!el) return;

    const newMin = b.min * minScale;
    const newMax = b.max * maxScale;

    el.min = newMin;
    el.max = newMax;

    // Clamp current value
    const cur = parseFloat(el.value);
    if (cur < newMin) el.value = newMin;
    if (cur > newMax) el.value = newMax;

    // Update left/right labels above each slider
    const row = el.previousElementSibling;
    if (row && row.children.length >= 3) {
      const left = row.children[0];
      const right = row.children[2];

      const step = parseFloat(el.step) || 1;
      const decimals = (step.toString().split('.')[1] || '').length;
      const fmt = n => (id.includes('Volume') ? Math.round(n).toLocaleString() : n.toFixed(decimals));

      if (b.unit === '$') {
        left.textContent = `$${fmt(newMin)}`;
        right.textContent = `$${fmt(newMax)}`;
      } else if (b.unit === '%') {
        left.textContent = `${fmt(newMin)}%`;
        right.textContent = `${fmt(newMax)}%`;
      } else {
        left.textContent = fmt(newMin);
        right.textContent = fmt(newMax);
      }
    }
  });

  calculate();
}

document.getElementById('applySliderRanges')?.addEventListener('click', applySliderBoundsFromScales);
    // Apply config
    document.getElementById('applyConfig').addEventListener('click', function() {
      const rnd = parseFloat(document.getElementById('rndExp').value);
      const sga = parseFloat(document.getElementById('sgaExp').value);
      const other = parseFloat(document.getElementById('otherExp').value);
      opEx = rnd + sga + other;
      document.getElementById('opEx').textContent = opEx.toLocaleString();
      calculate();
    });

    // Add event listeners to sliders
    const sliders = [
      'seaweedPrice', 'alginateYield', 'ethanolRecovery', 'microalgaeCost', 'macroBlend',
      'filmVolume', 'filmPrice', 'resinVolume', 'resinPrice', 'wastePrice'
    ];
    
    sliders.forEach(function(id) {
      document.getElementById(id).addEventListener('input', calculate);
    });

    // Initial calculation
    calculate();
  </script>
</body>
</html>
